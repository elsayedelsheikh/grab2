<?xml version="1.0" encoding="UTF-8"?>
<root BTCPP_format="4" main_tree_to_execute="MainTree">
  <BehaviorTree ID="MainTree">
    <Sequence>
      <SubTree ID="PickAndDrop" name="cube1"/>
      <SubTree ID="PickAndDrop" name="cube0"/>
      <SubTree ID="PickAndDrop" name="cube2"/>
    </Sequence>
  </BehaviorTree>

  <BehaviorTree ID="PickAndDrop">
    <Sequence>
      <Script code=" retract_pose:='0.34;0.3;0.6;1.0;0.0;0.0;0.0' " />
      <SubTree ID="MoveTo" target="{retract_pose}"/>
      <SubTree ID="Pick"/>
      <SubTree ID="MoveTo" target="{retract_pose}"/>
      <SubTree ID="Drop" target="0.34;-0.3;0.5;1.0;0.0;0.0;0.0"/>
    </Sequence>
  </BehaviorTree>

  <BehaviorTree ID="Pick">
    <Sequence>
      <GetGrasp pregrasp="{pregrasp_pose}" grasp="{grasp_pose}"/>
      <SubTree ID="MoveTo" target="{pregrasp_pose}"/>
      <Grip pose="0.04"/>
      <SubTree ID="MoveTo" target="{grasp_pose}"/>
      <Grip pose="0.02"/>
    </Sequence>
  </BehaviorTree>

  <BehaviorTree ID="Drop">
    <Sequence>
      <SubTree ID="MoveTo" target="{target}"/>
      <Grip pose="0.04"/>
    </Sequence>
  </BehaviorTree>

  <BehaviorTree ID="MoveTo">
    <Sequence>
      <Plan target_ik="{target}" trajectory="{trajectory_msg}"/>
      <Move trajectory="{trajectory_msg}"/>
    </Sequence>
  </BehaviorTree>

  <!-- Description of Node Models (used by Groot) -->
  <TreeNodesModel>
    <Action ID="GetGrasp" editable="true">
      <input_port name="pregrasp"/>
      <input_port name="grasp"/>
    </Action>
    <Action ID="Grip" editable="true">
      <input_port name="pose" default="0.04"/>
    </Action>
    <Action ID="Move" editable="true">
      <input_port name="trajectory"/>
    </Action>
    <Action ID="Plan" editable="true">
      <input_port name="target_ik"/>
      <output_port name="trajectory"/>
    </Action>
  </TreeNodesModel>

</root>
